# Application Blueprint: v0.3.0 (Identity)

**Series Code**: `ARC01-USER-01` **Status**: `Archived` (Released)

> **Spec Alignment:** This blueprint implements the **Security** requirements of the
> **[Internara Specs](../../../internara-specs.md)** (Section 10.6), specifically login via
> email/password and role-based access.

---

## 1. Core Problem Statement

A monolithic `User` model leads to a "God Object." We need a structure where identity (Login) is
decoupled from context (Profile) to support the specific roles defined in the specs.

**Goal**: Implement a polymorphic profile system.

---

## 2. Architectural Impact

### 2.1 Domain: Profile Polymorphism

- **Refactor**: `User` model remains lean (Credentials only).
- **New Module**: `Profile`.
- **Identity:** All profiles use **UUIDs**.

### 2.2 Security: Identity Hardening

- **Feature**: Automated **PII Masking** in logs.
- **Safeguard**: `UserPolicy` logic preventing SuperAdmin deletion.

---

## 3. UI/UX Strategy

- **Mobile-First:** Profile management forms must be responsive.
- **i11n:** Profile fields (e.g., "Major", "Position") must be localized.

---

## 4. Contract Definitions

| Contract         | Owner Module | Consumer | Purpose                                                                                       |
| :--------------- | :----------- | :------- | :-------------------------------------------------------------------------------------------- |
| `ProfileService` | `Profile`    | `User`   | Manages Profile CRUD and relationships via EloquentQuery, removing the need for a repository. |

---

## 5. Exit Criteria

- [x] **Separation of Concerns**: User table contains only auth data.
- [x] **Automated Onboarding**: Registration initializes the linked Profile (Student/Teacher).
- [x] **Spec Verification**: Security protocols align with specs.

---

## 6. vNext Roadmap (v0.4.0)

- **Institutional Context**: Adding Schools and Departments.
