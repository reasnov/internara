# Application Blueprint: v0.3.0 (Identity)

**Series Code**: `ARC01-USER-01` **Status**: `Archived` (Released)

---

## 1. Core Problem Statement

A monolithic `User` model often becomes a "God Object" containing columns for students, teachers,
and admins simultaneously. We need a structure that allows for multi-role users without polluting
the core authentication table.

**Goal**: Implement a polymorphic profile system where identity (Login) is decoupled from context
(Profile).

---

## 2. Architectural Impact

### 2.1 Domain: Profile Polymorphism

- **Refactor**: `User` model remains lean (Credentials only).
- **New Module**: `Profile`.
- **Logic**: `HasUserRelation` concern to dynamically link Users to Student/Teacher profiles.

### 2.2 Security: Identity Hardening

- **Feature**: Automated PII masking in logs.
- **Safeguard**: `UserPolicy` logic to preventing self-lockout or SuperAdmin deletion.

---

## 3. Contract Definitions

| Contract            | Owner Module | Consumer | Purpose                                                                          |
| :------------------ | :----------- | :------- | :------------------------------------------------------------------------------- |
| `ProfileRepository` | `Profile`    | `User`   | Allows the User module to fetch profile data without knowing the concrete class. |

---

## 4. Exit Criteria

The v0.3.0 series is considered complete when:

- [x] **Separation of Concerns**: User table contains only authentication data.
- [x] **Automated Onboarding**: Registration flows correctly initialize the linked Profile.
- [x] **Privacy**: Logs do not contain raw email addresses.

---

## 5. vNext Roadmap (v0.4.0)

- **Institutional Context**: Adding Schools and Departments.
- **Zero-Leak Database**: Implementing logical foreign keys.
