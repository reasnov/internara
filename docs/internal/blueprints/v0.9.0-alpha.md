# Application Blueprint: v0.9.0 (System Initialization)

**Series Code**: `ARC01-BOOT-01` **Status**: `Completed`

> **Spec Alignment:** This blueprint implements the **Platform and Technology** requirements
> (Section 5) and **Administrative Management** (Section 1) of the
> **[Internara Specs](../../internara-specs.md)**. It focuses on reducing deployment friction.

---

## 1. Version Goals and Scopes (Core Problem Statement)

**Purpose**: Automate the system initialization process to ensure a reliable and fast deployment
experience.

**Objectives**:

- Eliminate manual configuration errors during setup.
- Provide a professional onboarding experience for institutional administrators.

**Scope**: Deploying Internara currently requires manual CLI steps (migrations, seeding, env
configuration) which is prone to human error. This version introduces automated tools to handle
these tasks.

---

## 2. Functional Specifications

**Feature Set**:

- **Automated Installer CLI**: A single command (`app:install`) to bootstrap the entire environment.
- **Web Setup Wizard**: A 7-step graphical interface for initial configuration.
- **Setup Token Security**: CLI-generated authorization token to prevent unauthorized web access.

**User Stories**:

- As an **IT Staff**, I want to run a single command to install the system so that I don't miss
  critical setup steps.
- As a **Principal/Admin**, I want a web interface to configure my school's logo and name during the
  first run so that the system reflects our identity immediately.

---

## 3. Technical Architecture (Architectural Impact)

**Modules**:

- **Setup**: Dedicated module for installation and initialization logic.

**Data Layer**:

- **Seeding**: Orchestrated execution of Core and Shared seeders.
- **UUID Identity**: All created records utilize UUIDs.

**Security Logic**:

- **Middleware Protection**: `ProtectSetupRoute` and `RequireSetupAccess` strictly control wizard
  lifecycle.
- **One-Time Token**: 32-character random token required for initial web access, purged upon
  completion.
- **Self-Destruction**: Total lockdown of setup routes once `app_installed` is true and SuperAdmin
  exists.

**Settings**:

- Integration with the `Setting` module to persist `brand_name`, `brand_logo`, and SMTP details.

---

## 4. UX/UI Design Specifications (UI/UX Strategy)

**Design Philosophy**: Minimalist, guided, and high-trust onboarding.

**Finalized User Flow**:

1. **Welcome**: Introduction to Internara.
2. **Account**: Initial Super-Administrator registration.
3. **School**: Institutional identity configuration (Name, Logo).
4. **Department**: Defining academic pathways.
5. **Internship**: Setting up management periods.
6. **System**: SMTP and mail configuration.
7. **Complete**: Finalization and redirection to login.

**Mobile-First**:

- Setup Wizard is fully responsive, tested on multiple viewport sizes.

**Multi-Language**:

- Full support for **Indonesian** and **English** across all steps.

---

## 5. Success Metrics (KPIs)

- **Installation Velocity**: Reduced setup time from ~15 minutes to < 2 minutes.
- **Reliability**: Zero manual `.env` configuration errors required for standard installation.
- **Authorization**: 100% of web setup requests are authorized via CLI-generated tokens.

---

## 6. Quality Assurance (QA) Criteria (Exit Criteria)

**Acceptance Criteria**:

- [x] **Zero-Config Install**: `app:install` successfully bootstraps environment.
- [x] **Wizard Completion**: Institutional branding correctly persists to `setting()`.
- [x] **One-Time Use**: Setup module is inaccessible after completion.

**Testing Protocols**:

- [x] 100% Test Pass Rate for the `Setup` module (23 Tests).
- [x] **Feature Coverage**: End-to-end flow validated in `SetupFlowTest`.
- [x] **Unit Coverage**: Service logic validated in `SetupServiceTest` and `InstallerServiceTest`.

**Quality Gates**:

- [x] **Spec Verification**: Complies with SIM-PKL initialization requirements.
- [x] **Static Analysis**: Clean (`pint`, `lint`).
- [x] **Architecture**: Strict Modular Isolation maintained.

---

## 7. Implementation Summary

The system initialization flow has been successfully implemented with a strong focus on security and
architectural integrity.

- **Dependency Injection**: Refactored services and commands to use constructor-based DI.
- **Cross-Module Isolation**: Tests utilize service-resolved factories to maintain domain
  boundaries.
- **Security hardening**: Added `setup_token` verification to ensure that only administrators with
  server CLI access can initiate the web-based configuration.

---

## 8. vNext Roadmap (v0.10.0: Integrative Excellence & Competency Mastery)

- **Competency Mapping**: Linking journals to curriculum rubrics.
- **Mentoring Dialogue**: Formal feedback logs for Instructors/Mentors.
