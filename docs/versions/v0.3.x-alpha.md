# Overview: Version v0.3.x-alpha (User & Auth)

## 1. Version Details

- **Name**: `v0.3.x-alpha`
- **Series Code**: `ARC01-USER-01`
- **Status**: `Released`
- **Current Operational Context**: Stabilizing the identity system through robust user management
  and polymorphic profile relations.

---

## 2. Goals & Architectural Philosophy (Pre-Production)

### Problem Analysis (The "Why")

Academic systems require managing complex user data where different roles (Students, Teachers,
Admins) share core credentials but need distinct profile information. Manual provisioning and
inconsistent post-login experiences were identified as key barriers to a production-ready feel.

### Architectural Pillars (The "How")

We adopted **Profile Polymorphism** to handle role-specific data without bloating the core `User`
table. For the user experience, we prioritized a **Self-Service UI** using Livewire, empowering
users to independently manage their information and security settings within a unified dashboard.

### Architectural Constraints (The Rules)

The `User` module MUST NOT directly reference `Profile` models; communication is handled through
interfaces or service-driven modular relations. All administrative actions and status changes MUST
pass through the Service layer to ensure validation and event dispatching.

---

## 3. Production Keystones (Analytical Narrative)

### Keystone 1: Specialized Profile Polymorphism

#### Technical Rationale

To ensure scalability and clean data separation, we moved extended user attributes into a dedicated
`Profile` module. This prevents the `User` model from becoming a "God Object" as the system grows.

#### Implementation Deep-Dive

We enhanced the `UserService` to automatically initialize specialized profile records during user
creation. This was achieved using modular traits that establish decoupled relationships through
service interfaces. This allows the system to store NIP for Teachers and NISN for Students while
maintaining a single, lightweight authentication model.

#### Architectural Impact

This design makes Internara highly extensible. New institutional roles can be added by simply adding
profile attributes, without requiring migrations on the core authentication tables.

### Keystone 2: Security Hardening & SuperAdmin Safeguards

#### Technical Rationale

Administrative power must be balanced with strict safeguards to prevent accidental lockout or
unauthorized modification of the system's primary owner.

#### Implementation Deep-Dive

We implemented explicit ownership verification in the verification flows and integrated mandatory
`Gate::authorize` checks across all services. A critical safeguard was added to the `UserPolicy` and
`UserService` to block any standard administrator from deleting or deactivating the primary
SuperAdmin account.

#### Architectural Impact

This established a "Security-by-Design" posture. It guarantees system integrity and ensures that the
system's highest-level access is always protected by explicit policy logic.

---

## 4. Quality Assurance & Artifact Sync (Post-Production)

### 4.1. Verification Analysis

The test suite achieved 100% pass rate for registration and email verification flows. We performed a
mass-fix of namespace inconsistencies found during the sync cycle, ensuring that automated service
binding remained robust across all newly created modules.

### 4.2. Continuous Documentation Sync

The **Architecture Guide** was updated with real-world inter-module communication examples.
Standardized **Account Status Management** conventions were established and documented in the main
development guide.

### 4.3. Security & Privacy Audit

The audit identified and remediated a critical authentication bypass in the email verification
logic. We also integrated PII masking in application logs to ensure that sensitive data like emails
are not exposed in plain text.

### 4.4. Roadmap Strategy (vNext)

The next iteration (`v0.4.x`) will shift focus to the **Institutional** foundation, introducing
School and Department management to provide academic context to our user profiles.
