# Overview: Version v0.5.x-alpha (Operational)

## 1. Version Details

- **Name**: `v0.5.0-alpha`
- **Series Code**: `ARC01-OPER`
- **Status**: `In Progress`
- **Description**: This version focuses on the operational aspects of the internship, specifically tracking student daily activities, attendance, and facilitating the supervision relationships between students, teachers, and mentors.

---

## 2. Goals & Architectural Philosophy (Pre-Production)

### Problem Keypoints (Why we are doing this)

- **Lack of Activity Tracking:** No mechanism for students to record their daily tasks and learning outcomes.
- **Untracked Attendance:** Physical or remote attendance is currently not monitored.
- **Disconnected Supervision:** The relationships between Students, Industry Mentors, and School Teachers are not formally defined in the system.
- **UI Inconsistency:** Direct use of UI library classes across modules creates maintenance overhead and visual inconsistency.

### Architectural Pillars (How we solve it)

- **Operational Data Streams:** Managing high-frequency data inputs (journals, attendance logs) efficiently.
- **Geolocation Integration:** Validating attendance via location data using Haversine formulas to prevent fraud.
- **Relationship Management:** Formalizing the "Supervisor" role and linking it to placements via dedicated service logic, enabling clear hierarchy.
- **UI Abstraction:** Centralizing UI component definitions to the `UI` module to enforce consistency and simplify future design changes.

### Architectural Constraints (The Rules)

_Immutable rules defined for this version._

1.  **Constraint 1 (UI Centralization):** Direct use of Tailwind/DaisyUI classes for core elements (buttons, inputs, cards) in feature modules is **forbidden**. All modules must use the components provided by the `UI` module (e.g., `<x-ui::button>`).
2.  **Constraint 2 (Geolocation Mandatory):** Attendance records cannot be created without valid geolocation data (latitude/longitude) and a calculated distance check against the assigned `School` or `Company` location.
3.  **Constraint 3 (Journal Immutability):** Journal entries cannot be modified by students after supervisor verification. Modifications require an administrative reset or new entry.
4.  **Constraint 4 (Strict Typing):** All new Service methods must use strict return types and typed arguments. No `mixed` types unless absolutely necessary.
5.  **Constraint 5 (Media Isolation):** Journal attachments must be stored in a private disk and served via signed URLs or temporary links, ensuring privacy of student work.

---

## 3. Scope of Work / Keystones (Production)

### Format B: System Keystones (Features)

#### Keystone 1: UI Component Refactor

- **Goal**: Enforce visual consistency and reduce frontend maintenance by decoupling specific CSS frameworks from business views.
- **Status**: [x] Completed.
- **Implementation Rules**:
    - **Module**: `Modules\UI`.
    - **Components**: Create Blade components: `button`, `input`, `card`, `modal`, `badge`, `alert`, `table`, `header`, `tabs`, `tab`, `avatar`, `choices`, `dropdown`, `main`, `toast`.
    - **Refactor**: Systematically replaced raw HTML/MaryUI in `Auth`, `Dashboard`, `School`, `Department`, `User`, `Profile`, `Internship`, and `Setup` with these components.
    - **Standard**: Components must support slot injection and attribute merging (`$attributes->merge()`).
- **Developer Impact**: Changing a primary color or button style now requires editing only one file in the `UI` module, preventing design drift.

#### Keystone 2: Supervisor Matching

- **Goal**: Formalize the mentorship hierarchy and link Students to Supervisors to enable targeted management.
- **Status**: [x] Completed.
- **Implementation Rules**:
    - **Relationships**: `Internship` model now linked to `User` (teacher/mentor) via `InternshipRegistration`.
    - **Service Logic**: `SupervisorService` handles assignment and role-based validation.
    - **Dashboards**: Created "My Mentees" (Industry) and updated "Supervised Students" (Teacher) views.
- **Developer Impact**: Enables "My Students" scoped queries (`$query->where('teacher_id', $user->id)`) and standardized permission checks.

#### Keystone 3: The Journal Module (Logbook)

- **Goal**: Enable students to record and reflect on daily internship activities, providing supervisors with visibility into student progress.
- **Status**: [x] Completed.
- **Implementation Rules**:
    - **Model**: `JournalEntry` (UUID) with fields: 
        - `registration_id`: Reference to program.
        - `student_id`: Reference to student.
        - `date`: Entry date.
        - `work_topic`: (Topik Pekerjaan) Brief title of the task.
        - `activity_description`: Detailed log of tasks performed.
        - `basic_competence`: (Kompetensi Dasar) Linked to curriculum standards.
        - `character_values`: (Nilai-nilai Karakter) e.g., Discipline, Responsibility, Honesty.
        - `reflection`: Student's learning outcome.
        - `mood`: Student's emotional state.
    - **Service**: `JournalService` handling state transitions (`draft`, `submitted`, `approved`, `rejected`). 
        - **Approval Policy**: Dual-authority model. An entry can be approved by either the assigned **Industry Mentor** or the **School Teacher**. 
        - **Teacher Override**: Teachers have the authority to approve entries directly if the mentor is unavailable.
    - **Media**: Integrated `spatie/laravel-medialibrary` for private attachments with temporary URL generation.
    - **UI**: Interactive index with "Week at a Glance" sidebar and detail modal.
- **Developer Impact**: Provides a standardized logging mechanism and sets the foundation for the Assessment engine.

#### Keystone 4: The Attendance Module

- **Goal**: Verify student presence with location-based integrity to ensure compliance with internship requirements.
- **Implementation Rules**:
    - **Model**: `AttendanceLog` (UUID) with fields: `internship_id`, `check_in_at`, `check_out_at`, `check_in_lat`, `check_in_long`, `status` (present/late/absent).
    - **Geolocation**: `GeolocationService` must implement the Haversine formula. Distance threshold (e.g., 100m) should be configurable via `config/internara.php`.
    - **Validation**: Prevent double check-ins. Require `check_out` for the previous day before allowing new `check_in`.
- **Developer Impact**: Abstracts complex location math into a reusable service and provides a reliable audit trail for grading.

---

## 4. Quality Assurance & Finalization (Post-Production)

### 4.1. Quality Tooling & Tests

- [x] Pest Tests passed by run `composer test`.
- [x] Pint/Prettier formatting applied by run `composer lint`.

### 4.2. Verification Checks

- [x] **UI Consistency:** Visual regression check to ensure new UI components match the design and behave correctly on mobile.
- [ ] **Supervisor Access:** Verify supervisors only see their assigned students in the dashboard.
- [ ] **Journal Flow:** Verify student can post, edit (if draft), and supervisor can approve/reject.
- [ ] **Attendance Logic:** Verify blocking of clock-ins outside the allowed radius and double clock-in prevention.

### 4.3. Documentation Integrity

- [x] New modules (`Journal`, `Attendance`, `UI`) documented in `docs/main/modules/`.
- [x] `README.md`, `CHANGELOG.md`, and `SECURITY.md` updated.
- [x] Technical conventions updated (especially UI Guide).
- [x] Root TOC and Module TOCs updated.

### 4.4. Security Audit

- [ ] **Status**: Pending.
- [ ] **Check:** Validate signed URL generation for private Journal attachments.
- [ ] **Check:** Ensure Supervisor IDOR protection (cannot approve journals for unassigned students).

### 4.5. Roadmap & Next Steps (v0.6.x-alpha)

#### Must Have (Assessment & Finalization)

- **Multi-Perspective Assessment Engine:**
  - Configurable Assessment Aspects (e.g., Discipline, Technical Skill, Social Soft-skills).
  - **Dual Scoring Logic:** Separate input forms for Industry Mentors (Nilai DUDI) and School Teachers (Nilai Sekolah).
  - **Weighted Grading:** Configurable formula (e.g., `(Industry * 0.6) + (School * 0.4) = Final Grade`).
- **Certificate & Report Generation:**
  - PDF generation for "Certificate of Completion" (Sertifikat PKL).
  - PDF generation for "Academic Transcript" (Transkrip Nilai).
  - QR Code verification system for generated certificates.

#### Should Have (Automation & Administrative Tools)

- **Document Generator (Mail Merge Engine):**
  - Dynamic placeholders (`{{ student_name }}`, `{{ company_name }}`) for administrative letters.
  - Templates for: *Surat Pengantar* (Introductory Letter), *Surat Tugas* (Assignment Letter), and *MoU* (Agreements).
- **Notification System:**
  - Email/In-app alerts for "Missing Journal", "Assessment Due", and "Placement Approved".

#### Won't Have

- **Multi-school Multi-tenancy:** The system is strictly designed for a single school instance.
- **Public Job Portal:** Placements are managed internally; no public-facing job board for non-students.
- **Automated Industry Billing:** Financial transactions between school and industry are out of scope.
- **Alumni Tracer Study:** Tracking students post-graduation is out of scope for the internship system.

---

**Navigation**

[‚Üê Previous: v0.4.x-alpha (Institutional)](v0.4.x-alpha.md)
