# Vulnerability Management: Security Lifecycle Protocols

This document formalizes the **Vulnerability Management** protocol for the Internara project, standardized according to **ISO/IEC 27001** (Information security management) and **ISO/IEC 29147** (Vulnerability disclosure).

---

## 1. Vulnerability Discovery & Reporting

Vulnerabilities are identified through:
- **Public Disclosure**: External researchers reporting through the `SECURITY.md` protocol.
- **Automated Scanning (SAST/DAST)**: Continuous analysis within the CI/CD pipeline.
- **Manual Audits**: 3S Audit protocol performed during every pull request.

---

## 2. Severity Classification (CVSS Alignment)

Internara utilizes the **Common Vulnerability Scoring System (CVSS)** to prioritize remediation efforts.

| Severity | CVSS Score | Remidiation Window |
| :--- | :--- | :--- |
| **CRITICAL** | 9.0 - 10.0 | Within 24 hours of confirmation. |
| **HIGH** | 7.0 - 8.9 | Within 72 hours of confirmation. |
| **MEDIUM** | 4.0 - 6.9 | Within 7 days of confirmation. |
| **LOW** | 0.1 - 3.9 | Within 30 days of confirmation. |

---

## 3. Remediation Lifecycle

### 3.1 Identification & Triage
- **Acknowledgement**: Within 24 hours of receipt.
- **Validation**: Confirm the vulnerability and assign a preliminary CVSS score.

### 3.2 Mitigation & Patching
- **Fix Development**: Performed in a private, secure environment.
- **Verification**: Patch must be validated against existing regression tests and new security test cases.

### 3.3 Disclosure & Release
- **Advisory**: Publish a security advisory with the patch release (PATCH or MINOR version).
- **Transparency**: Update the `CHANGELOG.md` with the security fix details.

---

## 4. Software Bill of Materials (SBOM)

Internara maintains a real-time SBOM via `composer.lock` and `package-lock.json`.
- **Dependency Auditing**: Automated tools (e.g., GitHub Dependabot, `composer audit`) are used to track and patch vulnerable upstream dependencies.
- **Security Updates**: Mandatory security updates for the Laravel framework and critical packages.

---

## 5. Security Regression Prevention

- **Test-First Security**: Every vulnerability fix must include a dedicated security test case to prevent recurrence.
- **Automated Gates**: CI pipelines will block any deployment containing known critical vulnerabilities in dependencies.
